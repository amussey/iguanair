
top_srcdir = @top_srcdir@
srcdir = @srcdir@
top_builddir = @top_builddir@
builddir = @builddir@

include ../Make.settings

UTILS = $(IGMKCODE)
OBJ = $(IGMKCODE_OBJ)

PYTHON_SCRIPTS = record-sends clearID writeLCD

IGMKCODE = igmkcode
IGMKCODE_OBJ = igmkcode.o

all: $(UTILS) $(PYTHON_SCRIPTS)

%.o: $(srcdir)/%.c Makefile
	$(CC) -c $(CPPFLAGS) $(CFLAGS) $< -o $@

$(IGMKCODE): $(IGMKCODE_OBJ)
	$(CC) $(LDFLAGS) $^ -o $@

.PHONY: install
install: all
	$(INSTALL) -d -m 755 $(DESTDIR)/$(bindir)
	for f in $(UTILS); do \
	    $(INSTALL_PROGRAM) $$f $(DESTDIR)/$(bindir)/$$f; \
	done

.PHONY: uninstall
uninstall: 
	for f in $(UTILS); do \
	  $(RM) $(DESTDIR)/$(bindir)/i$$f; \
	done

.PHONY: clean
clean:
	$(RM) -f *~ $(UTILS) $(OBJ) $(PYTHON_SCRIPTS)

.PHONY: distclean
distclean: clean
	$(RM) -f Makefile

$(PYTHON_SCRIPTS): ../config.status
	cd .. && $(SHELL) ./config.status

Makefile: ../config.status $(srcdir)/Makefile.in
	cd .. && $(SHELL) ./config.status

